create sequence  COMPLAINT_NO_SEQ; 

CREATE TABLE WIFI_COMPLAINTS_T(
USER_NAME VARCHAR2(100),
COMPLAINT_NO NUMBER DEFAULT  COMPLAINT_NO_SEQ.NEXTVAL,
MAIN_COMPLAINT_TYPE VARCHAR2(100),
SUB_COMPLAINT_TYPE VARCHAR2(100),
DESCRIP VARCHAR2(100),
STATUS VARCHAR2(100) DEFAULT 'OPEN',
ADDED_DATE DATE  DEFAULT SYSDATE );

--CREATING PROCEDURE 


create or replace  procedure  WIFI_COMPLAINTS_REG_PROC(
P_USER_NAME VARCHAR2,
P_COMPLAINT_TYPE VARCHAR2,
P_SUB_COMPLAINT_TYPE VARCHAR2,
P_DESCRIPTION VARCHAR2,
P_MSG          OUT VARCHAR2)
AS
BEGIN

INSERT INTO  WIFI_COMPLAINTS_T(
USER_NAME,
MAIN_COMPLAINT_TYPE,
SUB_COMPLAINT_TYPE,
DESCRIP)
VALUES(
P_USER_NAME,
P_COMPLAINT_TYPE,
P_SUB_COMPLAINT_TYPE,
P_DESCRIPTION);

COMMIT;
 
 P_MSG:='Complaint Registered Successfully';
 
 END  WIFI_COMPLAINTS_REG_PROC ;

---EXECUTE PROCEDURE 

DECLARE 
MSG VARCHAR2(100);
BEGIN
WIFI_COMPLAINTS_REG_PROC(
'JHON',
'SPEED ISSUE',
'SLOW BROWSING',
'NET IS SLOW',
MSG
);
DBMS_OUTPUT.PUT_LINE(MSG);


END;

SELECT * FROM WIFI_COMPLAINTS_T;

--WIFI COMPLAINT DISPLAY

--for this purpose procedure 


CREATE OR REPLACE PROCEDURE  WIFI_COMPLAINTS_LIST_PROC(
P_USER_NAME VARCHAR2,
P_COMPLAINT_NO  OUT NUMBER ,
P_STATUS OUT VARCHAR2,
P_COMPLAINT_TYPE OUT VARCHAR2,
P_ADDED_DATE OUT VARCHAR2)
 AS
 BEGIN
 SELECT COMPLAINT_NO,STATUS,MAIN_COMPLAINT_TYPE||'('||SUB_COMPLAINT_TYPE||')'
 COMPLAINT_TYPE, ADDED_DATE INTO 
 P_COMPLAINT_NO,
 P_STATUS,
 P_COMPLAINT_TYPE,
 P_ADDED_DATE FROM WIFI_COMPLAINTS_T
 WHERE STATUS ='OPEN'AND USER_NAME=P_USER_NAME ;
 
 END WIFI_COMPLAINTS_LIST_PROC;


---EXECUTE PROCEDURE

DECLARE 
L_COMPLAINT_NO  NUMBER ;
L_STATUS  VARCHAR2(100);
L_COMPLAINT_TYPE  VARCHAR2(100);
L_ADDED_DATE  VARCHAR2(100);

BEGIN
WIFI_COMPLAINTS_LIST_PROC('JHON',L_COMPLAINT_NO,L_STATUS,L_COMPLAINT_TYPE,L_ADDED_DATE);
DBMS_OUTPUT.PUT_LINE(L_COMPLAINT_NO||' '||L_STATUS||' '||L_COMPLAINT_TYPE|| ' '||L_ADDED_DATE);

END;
























